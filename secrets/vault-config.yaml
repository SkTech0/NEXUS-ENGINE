# HashiCorp Vault integration scaffold (NO SECRETS STORED HERE)
#
# This file documents a standard Vault usage pattern for Nexus Engine.
# It is NOT wired into runtime unless explicitly integrated.
#
# Recommended precedence:
#   defaults → env pack → Vault → runtime overrides
#
# Secret paths are examples. Use environment-specific prefixes:
#   nexus-engine/<env>/...
#
schemaVersion: 1

vault:
  # Override via env: Secrets__Vault__Address
  address: ${VAULT_ADDR}
  # Supported auth patterns:
  # - token (local/dev only; avoid in prod)
  # - kubernetes (recommended for k8s)
  # - approle (CI/CD or controlled server-side use)
  auth:
    method: kubernetes

    token:
      # local-only fallback. DO NOT COMMIT TOKENS.
      tokenEnvVar: VAULT_TOKEN

    kubernetes:
      roleEnvVar: VAULT_K8S_ROLE
      # Typically mounted by Kubernetes at this location.
      jwtPath: /var/run/secrets/kubernetes.io/serviceaccount/token

    approle:
      roleIdEnvVar: VAULT_ROLE_ID
      secretIdEnvVar: VAULT_SECRET_ID

  kv:
    # KV v2 mount name (often "kv" or "secret")
    mount: kv
    # Environment scoped prefix: e.g. "nexus-engine/prod"
    prefixEnvVar: VAULT_KV_PREFIX

  # Standard secret keys (examples)
  keys:
    # Prevent leaking connection strings into logs:
    ConnectionStrings:Primary:
      pathTemplate: "{mount}/data/{prefix}/db"
      field: primary

    Ai:AzureOpenAI:ApiKey:
      pathTemplate: "{mount}/data/{prefix}/ai/azure-openai"
      field: apiKey

    Ai:OpenAI:ApiKey:
      pathTemplate: "{mount}/data/{prefix}/ai/openai"
      field: apiKey

